%initial data matrix V is comprised of:
%columns which represent documents
%rows which represent words we are interested in
%frequency of each word in each document in each cell

V =[ 4 53 1 31 1 2 41 11 11 10 4 182 0 7 1 0 7 77 10 0 1 8 3 7; 
 9 29 0 19 0 1 8 28 6 5 0 24 0 1 0 3 4 3 4 2 0 0 0 10; 
 13 32 0 13 0 1 16 29 11 5 0 39 0 1 0 0 1 8 2 2 0 0 0 6; 
 0 21 0 6 1 0 3 0 9 0 2 5 0 39 0 0 0 0 0 0 0 0 0 3; 
 0 9 1 13 1 1 2 2 1 0 1 38 0 2 0 1 0 14 0 0 0 0 0 2; 
 0 18 0 9 1 1 15 2 6 0 1 61 0 6 1 3 8 16 1 0 0 0 1 2; 
 3 12 1 3 1 0 52 5 1 0 0 33 1 1 2 2 9 41 1 0 9 2 0 16; 
 1 1 0 11 3 0 18 0 0 1 0 12 0 3 0 2 12 23 0 0 15 0 2 2; 
 2 8 1 1 0 0 57 1 0 0 0 23 0 5 1 1 11 73 1 0 18 3 0 28; 
 0 3 1 2 0 0 8 2 0 0 0 11 0 0 1 0 3 19 1 0 1 0 2 3; 
 5 33 0 41 0 6 20 4 5 5 0 22 4 13 1 2 4 21 8 1 11 3 1 15; 
 1 10 0 2 0 3 62 0 1 0 4 24 3 0 1 3 4 34 4 1 10 0 3 4; 
 0 13 1 8 2 0 40 0 1 2 1 27 0 2 0 4 2 26 1 1 1 0 0 3; 
 1 1 0 0 0 0 10 1 0 0 1 19 1 1 0 0 1 19 0 0 1 0 2 0; 
 3 6 3 24 3 2 9 2 2 4 1 15 1 0 0 0 12 6 1 1 4 0 3 0; 
 0 14 1 3 0 0 1 0 1 0 0 2 1 0 0 0 8 1 0 0 2 0 0 1; 
 4 12 0 162 0 7 2 4 1 0 0 12 1 0 0 8 2 13 1 1 1 0 7 3; 
 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 5 0 0 5 0 0 2; 
 1 6 0 3 0 0 68 0 4 0 1 34 0 2 0 2 21 50 3 0 13 2 3 17; 
 0 7 0 0 0 1 2 0 0 0 0 1 0 0 0 1 1 2 0 3 0 0 0 0; 
 0 5 0 9 0 0 0 0 1 0 2 2 0 0 1 0 0 3 0 0 0 0 2 0; 
 1 10 0 52 2 1 8 4 1 4 0 33 0 0 2 3 6 28 7 0 1 8 2 5; 
 3 3 0 0 2 0 7 0 0 2 0 28 3 0 0 1 5 35 0 0 0 0 1 2; 
 2 5 2 8 0 0 5 3 0 3 2 64 3 0 0 0 5 65 1 0 0 1 0 7; 
 0 1 0 21 0 1 3 2 0 1 0 1 0 0 0 0 1 2 0 0 4 0 0 1; 
 0 1 0 1 1 0 7 0 1 0 0 9 0 0 0 0 0 7 0 0 0 0 0 1; 
 2 8 1 1 0 0 57 1 0 0 0 23 0 5 1 1 11 73 1 0 18 3 0 28; 
 0 0 0 0 0 0 54 0 1 0 2 5 0 0 0 0 2 11 1 0 0 1 0 2; 
 1 3 0 4 3 0 1 0 1 0 0 6 0 3 0 1 0 7 0 0 0 0 0 1; 
 0 2 0 1 0 0 8 0 0 0 2 7 0 0 0 0 5 15 1 0 5 0 0 4; 
 3 16 0 44 0 3 26 7 5 2 36 36 4 12 0 0 0 8 3 0 0 1 1 3; 
 0 7 0 10 0 0 6 1 4 0 2 8 0 8 0 0 1 1 0 0 0 1 1 0; 
 7 54 0 101 2 16 15 20 2 1 4 57 0 40 0 3 4 9 0 0 0 0 0 8; 
 3 17 0 31 3 1 2 8 1 2 0 26 0 0 0 0 4 4 0 0 1 0 1 15; 
 3 10 2 16 2 0 2 19 0 0 1 25 0 0 0 1 14 5 2 2 0 0 0 17; 
 1 9 1 1 0 0 21 0 3 1 3 4 0 0 0 2 1 7 0 2 0 0 4 16; 
 11 33 0 10 0 2 5 7 2 1 0 9 0 0 0 5 3 3 2 1 0 0 2 25 ];

V = V + eps;
rank = 6;
W = 2 * rand(size(V, 1), rank);
H = 2 * rand(rank, size(V, 2));
iteration = 2000;
for i = 1:iteration
    W = W .* ((V*H') ./ (W*(H*H') + eps));
    H = H .* ((W'*V) ./ ((W'*W)*H) + eps);
end

disp(W)
disp(H)
disp(H')